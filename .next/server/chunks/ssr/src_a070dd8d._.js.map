{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 5, "column": 0}, "map": {"version":3,"sources":["file:///F:/WebDevSimplified/job-board-ai/src/features/jobListingApplications/actions/schemas.ts"],"sourcesContent":["import { z } from \"zod\"\r\n\r\nexport const newJobListingApplicationSchema = z.object({\r\n  coverLetter: z\r\n    .string()\r\n    .transform(val => (val.trim() === \"\" ? null : val))\r\n    .nullable(),\r\n})\r\n"],"names":[],"mappings":";;;AAAA;AAAA;;AAEO,MAAM,iCAAiC,iLAAA,CAAA,IAAC,CAAC,MAAM,CAAC;IACrD,aAAa,iLAAA,CAAA,IAAC,CACX,MAAM,GACN,SAAS,CAAC,CAAA,MAAQ,IAAI,IAAI,OAAO,KAAK,OAAO,KAC7C,QAAQ;AACb","debugId":null}},
    {"offset": {"line": 20, "column": 0}, "map": {"version":3,"sources":["file:///F:/WebDevSimplified/job-board-ai/src/features/jobListingApplications/db/jobListingsApplications.ts"],"sourcesContent":["import { db } from \"@/drizzle/db\"\r\nimport { JobListingApplicationTable } from \"@/drizzle/schema\"\r\nimport { revalidateJobListingApplicationCache } from \"./cache/jobListingApplications\"\r\nimport { and, eq } from \"drizzle-orm\"\r\n\r\nexport async function insertJobListingApplication(\r\n  application: typeof JobListingApplicationTable.$inferInsert\r\n) {\r\n  await db.insert(JobListingApplicationTable).values(application)\r\n\r\n  revalidateJobListingApplicationCache(application)\r\n}\r\n\r\nexport async function updateJobListingApplication(\r\n  {\r\n    jobListingId,\r\n    userId,\r\n  }: {\r\n    jobListingId: string\r\n    userId: string\r\n  },\r\n  data: Partial<typeof JobListingApplicationTable.$inferInsert>\r\n) {\r\n  await db\r\n    .update(JobListingApplicationTable)\r\n    .set(data)\r\n    .where(\r\n      and(\r\n        eq(JobListingApplicationTable.jobListingId, jobListingId),\r\n        eq(JobListingApplicationTable.userId, userId)\r\n      )\r\n    )\r\n\r\n  revalidateJobListingApplicationCache({ jobListingId, userId })\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AAAA;AACA;AACA;;;;;;;;;AAEO,eAAe,4BACpB,WAA2D;IAE3D,MAAM,oHAAA,CAAA,KAAE,CAAC,MAAM,CAAC,iJAAA,CAAA,6BAA0B,EAAE,MAAM,CAAC;IAEnD,CAAA,GAAA,kLAAA,CAAA,uCAAoC,AAAD,EAAE;AACvC;AAEO,eAAe,4BACpB,EACE,YAAY,EACZ,MAAM,EAIP,EACD,IAA6D;IAE7D,MAAM,oHAAA,CAAA,KAAE,CACL,MAAM,CAAC,iJAAA,CAAA,6BAA0B,EACjC,GAAG,CAAC,MACJ,KAAK,CACJ,CAAA,GAAA,kKAAA,CAAA,MAAG,AAAD,EACA,CAAA,GAAA,kKAAA,CAAA,KAAE,AAAD,EAAE,iJAAA,CAAA,6BAA0B,CAAC,YAAY,EAAE,eAC5C,CAAA,GAAA,kKAAA,CAAA,KAAE,AAAD,EAAE,iJAAA,CAAA,6BAA0B,CAAC,MAAM,EAAE;IAI5C,CAAA,GAAA,kLAAA,CAAA,uCAAoC,AAAD,EAAE;QAAE;QAAc;IAAO;AAC9D","debugId":null}},
    {"offset": {"line": 53, "column": 0}, "map": {"version":3,"sources":["file:///F:/WebDevSimplified/job-board-ai/src/services/clerk/lib/orgUserPermissions.ts"],"sourcesContent":["import { auth } from \"@clerk/nextjs/server\"\r\n\r\ntype UserPermission =\r\n  | \"org:job_listings:create\"\r\n  | \"org:job_listings:update\"\r\n  | \"org:job_listings:delete\"\r\n  | \"org:job_listings:change_status\"\r\n  | \"org:job_listing_applications:change_rating\"\r\n  | \"org:job_listing_applications:change_stage\"\r\n\r\nexport async function hasOrgUserPermission(permission: UserPermission) {\r\n  const { has } = await auth()\r\n  return has({ permission })\r\n}\r\n"],"names":[],"mappings":";;;AAAA;;AAUO,eAAe,qBAAqB,UAA0B;IACnE,MAAM,EAAE,GAAG,EAAE,GAAG,MAAM,CAAA,GAAA,mLAAA,CAAA,OAAI,AAAD;IACzB,OAAO,IAAI;QAAE;IAAW;AAC1B","debugId":null}},
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///F:/WebDevSimplified/job-board-ai/src/features/jobListingApplications/actions/actions.ts"],"sourcesContent":["\"use server\"\r\n\r\nimport { db } from \"@/drizzle/db\"\r\nimport {\r\n  ApplicationStage,\r\n  applicationStages,\r\n  JobListingTable,\r\n  UserResumeTable,\r\n} from \"@/drizzle/schema\"\r\nimport { getJobListingIdTag } from \"@/features/jobListings/db/cache/jobListings\"\r\nimport { getUserResumeIdTag } from \"@/features/users/db/cache/userResumes\"\r\nimport {\r\n  getCurrentOrganization,\r\n  getCurrentUser,\r\n} from \"@/services/clerk/lib/getCurrentAuth\"\r\nimport { and, eq } from \"drizzle-orm\"\r\nimport { cacheTag } from \"next/dist/server/use-cache/cache-tag\"\r\nimport { z } from \"zod\"\r\nimport { newJobListingApplicationSchema } from \"./schemas\"\r\nimport {\r\n  insertJobListingApplication,\r\n  updateJobListingApplication,\r\n} from \"../db/jobListingsApplications\"\r\nimport { inngest } from \"@/services/inngest/client\"\r\nimport { hasOrgUserPermission } from \"@/services/clerk/lib/orgUserPermissions\"\r\n\r\nexport async function createJobListingApplication(\r\n  jobListingId: string,\r\n  unsafeData: z.infer<typeof newJobListingApplicationSchema>\r\n) {\r\n  const permissionError = {\r\n    error: true,\r\n    message: \"You don't have permission to submit an application\",\r\n  }\r\n  const { userId } = await getCurrentUser()\r\n  if (userId == null) return permissionError\r\n\r\n  const [userResume, jobListing] = await Promise.all([\r\n    getUserResume(userId),\r\n    getPublicJobListing(jobListingId),\r\n  ])\r\n  if (userResume == null || jobListing == null) return permissionError\r\n\r\n  const { success, data } = newJobListingApplicationSchema.safeParse(unsafeData)\r\n\r\n  if (!success) {\r\n    return {\r\n      error: true,\r\n      message: \"There was an error submitting your application\",\r\n    }\r\n  }\r\n\r\n  await insertJobListingApplication({\r\n    jobListingId,\r\n    userId,\r\n    ...data,\r\n  })\r\n\r\n  await inngest.send({\r\n    name: \"app/jobListingApplication.created\",\r\n    data: { jobListingId, userId },\r\n  })\r\n\r\n  return {\r\n    error: false,\r\n    message: \"Your application was successfully submitted\",\r\n  }\r\n}\r\n\r\nexport async function updateJobListingApplicationStage(\r\n  {\r\n    jobListingId,\r\n    userId,\r\n  }: {\r\n    jobListingId: string\r\n    userId: string\r\n  },\r\n  unsafeStage: ApplicationStage\r\n) {\r\n  const { success, data: stage } = z\r\n    .enum(applicationStages)\r\n    .safeParse(unsafeStage)\r\n\r\n  if (!success) {\r\n    return {\r\n      error: true,\r\n      message: \"Invalid stage\",\r\n    }\r\n  }\r\n\r\n  if (\r\n    !(await hasOrgUserPermission(\"org:job_listing_applications:change_stage\"))\r\n  ) {\r\n    return {\r\n      error: true,\r\n      message: \"You don't have permission to update the stage\",\r\n    }\r\n  }\r\n\r\n  const { orgId } = await getCurrentOrganization()\r\n  const jobListing = await getJobListing(jobListingId)\r\n  if (\r\n    orgId == null ||\r\n    jobListing == null ||\r\n    orgId !== jobListing.organizationId\r\n  ) {\r\n    return {\r\n      error: true,\r\n      message: \"You don't have permission to update the stage\",\r\n    }\r\n  }\r\n\r\n  await updateJobListingApplication(\r\n    {\r\n      jobListingId,\r\n      userId,\r\n    },\r\n    { stage }\r\n  )\r\n}\r\n\r\nexport async function updateJobListingApplicationRating(\r\n  {\r\n    jobListingId,\r\n    userId,\r\n  }: {\r\n    jobListingId: string\r\n    userId: string\r\n  },\r\n  unsafeRating: number | null\r\n) {\r\n  const { success, data: rating } = z\r\n    .number()\r\n    .min(1)\r\n    .max(5)\r\n    .nullish()\r\n    .safeParse(unsafeRating)\r\n\r\n  if (!success) {\r\n    return {\r\n      error: true,\r\n      message: \"Invalid rating\",\r\n    }\r\n  }\r\n\r\n  if (\r\n    !(await hasOrgUserPermission(\"org:job_listing_applications:change_rating\"))\r\n  ) {\r\n    return {\r\n      error: true,\r\n      message: \"You don't have permission to update the rating\",\r\n    }\r\n  }\r\n\r\n  const { orgId } = await getCurrentOrganization()\r\n  const jobListing = await getJobListing(jobListingId)\r\n  if (\r\n    orgId == null ||\r\n    jobListing == null ||\r\n    orgId !== jobListing.organizationId\r\n  ) {\r\n    return {\r\n      error: true,\r\n      message: \"You don't have permission to update the rating\",\r\n    }\r\n  }\r\n\r\n  await updateJobListingApplication(\r\n    {\r\n      jobListingId,\r\n      userId,\r\n    },\r\n    { rating }\r\n  )\r\n}\r\n\r\nasync function getPublicJobListing(id: string) {\r\n  \"use cache\"\r\n  cacheTag(getJobListingIdTag(id))\r\n\r\n  return db.query.JobListingTable.findFirst({\r\n    where: and(\r\n      eq(JobListingTable.id, id),\r\n      eq(JobListingTable.status, \"published\")\r\n    ),\r\n    columns: { id: true },\r\n  })\r\n}\r\n\r\nasync function getJobListing(id: string) {\r\n  \"use cache\"\r\n  cacheTag(getJobListingIdTag(id))\r\n\r\n  return db.query.JobListingTable.findFirst({\r\n    where: eq(JobListingTable.id, id),\r\n    columns: { organizationId: true },\r\n  })\r\n}\r\n\r\nasync function getUserResume(userId: string) {\r\n  \"use cache\"\r\n  cacheTag(getUserResumeIdTag(userId))\r\n\r\n  return db.query.UserResumeTable.findFirst({\r\n    where: eq(UserResumeTable.userId, userId),\r\n    columns: { userId: true },\r\n  })\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 279, "column": 0}, "map": {"version":3,"sources":["file:///F:/WebDevSimplified/job-board-ai/src/features/jobListings/components/JobListingFilterForm.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const JobListingFilterForm = registerClientReference(\n    function() { throw new Error(\"Attempted to call JobListingFilterForm() from the server but JobListingFilterForm is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/features/jobListings/components/JobListingFilterForm.tsx <module evaluation>\",\n    \"JobListingFilterForm\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,uBAAuB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACtD;IAAa,MAAM,IAAI,MAAM;AAAwP,GACrR,8FACA","debugId":null}},
    {"offset": {"line": 291, "column": 0}, "map": {"version":3,"sources":["file:///F:/WebDevSimplified/job-board-ai/src/features/jobListings/components/JobListingFilterForm.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const JobListingFilterForm = registerClientReference(\n    function() { throw new Error(\"Attempted to call JobListingFilterForm() from the server but JobListingFilterForm is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/features/jobListings/components/JobListingFilterForm.tsx\",\n    \"JobListingFilterForm\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,uBAAuB,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACtD;IAAa,MAAM,IAAI,MAAM;AAAwP,GACrR,0EACA","debugId":null}},
    {"offset": {"line": 303, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 311, "column": 0}, "map": {"version":3,"sources":["file:///F:/WebDevSimplified/job-board-ai/src/app/%28job-seeker%29/_shared/JobBoardSidebar.tsx"],"sourcesContent":["import { SidebarGroup, SidebarGroupContent } from \"@/components/ui/sidebar\"\r\nimport { JobListingFilterForm } from \"@/features/jobListings/components/JobListingFilterForm\"\r\n\r\nexport function JobBoardSidebar() {\r\n  return (\r\n    <SidebarGroup className=\"group-data-[state=collapsed]:hidden\">\r\n      <SidebarGroupContent className=\"px-1\">\r\n        <JobListingFilterForm />\r\n      </SidebarGroupContent>\r\n    </SidebarGroup>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;;AAEO,SAAS;IACd,qBACE,8OAAC,mIAAA,CAAA,eAAY;QAAC,WAAU;kBACtB,cAAA,8OAAC,mIAAA,CAAA,sBAAmB;YAAC,WAAU;sBAC7B,cAAA,8OAAC,qKAAA,CAAA,uBAAoB;;;;;;;;;;;;;;;AAI7B","debugId":null}},
    {"offset": {"line": 345, "column": 0}, "map": {"version":3,"sources":["file:///F:/WebDevSimplified/job-board-ai/src/app/%28job-seeker%29/%40sidebar/job-listings/%5BjobListingId%5D/page.tsx"],"sourcesContent":["import { JobBoardSidebar } from \"../../../_shared/JobBoardSidebar\"\r\n\r\nexport default function JobBoardSidebarPage() {\r\n  return <JobBoardSidebar />\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;;;AAEe,SAAS;IACtB,qBAAO,8OAAC,8JAAA,CAAA,kBAAe;;;;;AACzB","debugId":null}}]
}